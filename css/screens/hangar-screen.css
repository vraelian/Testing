/* css/screens/hangar-screen.css */

/* ================================================================================
CORE THEME & VARIABLE SETUP
- Defines the color palette, fonts, and dynamic variables used throughout the component.
- Theming is driven by CSS variables to allow for easy changes based on game state (e..g., location).
================================================================================
*/
:root {
    /* Base Colors */
    --ot-bg-dark: #0c101d;
    --ot-border-light: #4a6a8a;
    --ot-text-primary: #d0d8e8;
    --ot-text-secondary: #9ca3af;
    /* --- VIRTUAL WORKBENCH (A) --- */
    /* MODIFIED: Changed from #4ade80 to #16a34a for a richer green */
    --ot-green-accent: #16a34a;
    /* --- END VIRTUAL WORKBENCH --- */
    --ot-red-accent: #f87171;
    --ot-cyan-base: #22d3ee;
    --ot-cyan-glow: #67e8f9;

    /* Toggle & Mode-Specific Colors */
    --ot-hangar-red-base: #ef4444;
    --ot-hangar-red-glow: #f87171;
    --ot-shipyard-blue-base: #60a5fa;
    --ot-shipyard-blue-glow: #93c5fd;

    /* Ship Class Colors */
  
    --class-s-color: #facc15; /* Gold */
    --class-a-color: #60a5fa; /* Blue */
    --class-b-color: #4ade80; /* Green */
    --class-c-color: #e5e7eb; /* White/Light Grey */
    
    /* --- VIRTUAL WORKBENCH (New Class Colors) --- */
    --class-o-color: #fb923c; /* Orange (Capital) */
    --class-z-color: #ef4444; /* Red (Alien) */
    --class-f-color: #9ca3af; /* Grey (Flotsam) */
    /* --- END VIRTUAL WORKBENCH --- */
    
    /* Placeholder Theme (Saturn) - In the final game, these will be dynamically set.
 */
    --theme-color-primary: #fde047;
    --theme-color-glow: #fef08a;
    --theme-bg-gradient: linear-gradient(145deg, rgba(113, 63, 18, 0.5), rgba(49, 46, 129, 0.8));

    /* Dynamic Frame Border Color - Changes based on Hangar/Shipyard mode */
    --frame-border-color: var(--ot-shipyard-blue-base);
}

/* Set Hangar-specific frame color when the .mode-hangar class is active */
#ship-terminal-container.mode-hangar {
    --frame-border-color: var(--ot-hangar-red-base);
}


/* ================================================================================
COMPONENT-SPECIFIC STYLING
================================================================================
*/

#ship-terminal-container {
    margin-top: -0.9625rem;
}

/* Carousel: Main container for ship cards */
.carousel-container { 
    width: 100%;
    position: relative;
    cursor: grab;
    flex-grow: 1; /* Ensure this container fills available vertical space */
    display: flex;
}
.carousel-container:active {
    cursor: grabbing;
}

#hangar-carousel {
    display: flex; /* Lays out the pages side-by-side */
    height: 100%;
    width: 100%;
    /* ALWAYS have the transition property defined in CSS for smooth animations */
    transition: transform 0.4s ease-out;
}
.carousel-page {
    width: 100%;
    flex-shrink: 0; /* Prevents the page from shrinking */
    display: flex; 
    flex-direction: column; 
    user-select: none;
    padding-bottom: 4.0rem; /* New: Add space at the bottom for the absolute-positioned paginator */
}

/* Backgrounds & Theming */
#ship-terminal {
    
background-image: var(--theme-bg-gradient); /* Base theme from location */
    display: flex; 
    flex-direction: column; 
    flex-grow: 1; /* Make the card itself grow to fill the page */
    height: auto;
/* --- VIRTUAL WORKBENCH --- */
    /* Add relative positioning for the new pseudo-element */
    position: relative;
    /* --- END VIRTUAL WORKBENCH --- */
}

/* --- VIRTUAL WORKBENCH: ADD GLOW PSEUDO-ELEMENT --- */
/*
 * This is the new high-performance glow element.
 * It's a theme-colored radial gradient, hidden by default.
 * The 'dematerialize' animation will animate its opacity and transform.
*/
#ship-terminal::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -1; /* Sit behind the card content */
    border-radius: 0.5rem; /* rounded-lg, matching the card */
    
    /* Use the theme border color for the glow */
    background: radial-gradient(circle, var(--frame-border-color) 30%, transparent 70%);
    
    opacity: 0; /* Hidden by default */
    pointer-events: none; /* Ignore clicks */
    
    /* Set defaults for animation */
    transform-origin: center;
    transform: scale(0.5);
}
/* --- END VIRTUAL WORKBENCH --- */

/* --- VIRTUAL WORKBENCH: ADD ACTIVE SHIP GLOW --- */
@keyframes pulse-red-border-glow {
    0%, 100% {
        /* Use the base red color and a standard glow */
        border-color: var(--ot-hangar-red-base);
        box-shadow: 0 0 10px var(--ot-hangar-red-glow), 0 0 15px var(--ot-hangar-red-glow), inset 0 0 8px rgba(239, 68, 68, 0.2);
    }
    50% {
        /* Use the brighter glow color and a more intense shadow */
        border-color: var(--ot-hangar-red-glow);
        box-shadow: 0 0 15px var(--ot-hangar-red-glow), 0 0 25px var(--ot-hangar-red-glow), inset 0 0 12px rgba(239, 68, 68, 0.3);
    }
}

.active-ship {
    /* * This !important rule is crucial. It overrides the default --frame-border-color
     * (which is blue) and fixes the bug where the card gets "stuck" on blue
     * after the boarding animation.
    */
    border-color: var(--ot-hangar-red-base) !important;
    
    /* This applies the new persistent red glow animation */
    animation: pulse-red-border-glow 2.5s infinite ease-in-out;
}
/* --- END VIRTUAL WORKBENCH --- */

/* --- VIRTUAL WORKBENCH: ADD GREEN BUTTON GLOW KEYFRAMES (Request A) --- */
@keyframes pulse-green-button-glow {
    0%, 100% {
        /* Use the green variables from :root */
        background-color: var(--ot-green-accent);
        box-shadow: 0 0 10px var(--class-b-color), 0 0 15px var(--class-b-color);
        transform: scale(1);
    }
    50% {
        /* Use the brighter green for the pulse */
        background-color: var(--class-b-color);
        box-shadow: 0 0 15px var(--class-b-color), 0 0 25px var(--class-b-color);
        transform: scale(1.05);
    }
}
/* --- END VIRTUAL WORKBENCH --- */


/* The new intermediate container for constraining height */
#ship-card-main-content {
    
flex: 1 1 auto; /* Grow to fill space */
    min-height: 0; /* CRUCIAL for allowing the child to scroll */
    display: flex;
    flex-direction: column;
}

/* The scrollable grid content wrapper */
.ship-card-content-wrapper {
    overflow-y: auto; 
    scrollbar-width: none;
    display: grid; 
    grid-template-columns: repeat(5, minmax(0, 1fr));
    gap: 1rem;
    padding: 1rem;
    /* --- VIRTUAL WORKBENCH (Clipping Fix) --- */
    /* flex-grow: 1; */ /* REMOVED: This was causing the container to grow instead of scroll */
    /* --- END VIRTUAL WORKBENCH --- */
}
.ship-card-content-wrapper::-webkit-scrollbar {
    display: none; 
}

/* Force grid columns to behave as flex containers to distribute space */
.ship-card-content-wrapper > .col-span-2,
.ship-card-content-wrapper > .col-span-3 {
    display: flex;
    flex-direction: column;
}


#ship-terminal-container.mode-hangar #ship-terminal {
    background-blend-mode: overlay;
    background-color: #1a193d;
}
#ship-terminal-container.mode-hangar #ship-terminal::after { 
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image:
        radial-gradient(circle at 10px 10px, rgba(255,255,255,0.05) 1px, transparent 1px);
    background-size: 20px 20px;
    pointer-events: none;
}


/* Hologram */
.ship-display-area { 
    perspective: 1500px; 
    position: relative; 
    flex-grow: 1; /* Pushes buttons down */
}

/* --- [[START]] VIRTUAL WORKBENCH (Phase 3) --- */
/* REMOVED .ship-info-button styles */
/* --- [[END]] VIRTUAL WORKBENCH (Phase 3) --- */

.ship-image-placeholder { 
    background: transparent; 
    border: 1px solid var(--ot-border-light); 
    color: var(--theme-color-primary); 
    box-shadow: inset 0 0 15px rgba(0,0,0,0.3);
    /* --- VIRTUAL WORKBENCH (Request B) --- */
    aspect-ratio: 1 / 1; /* Make it a 1:1 square */
    /* --- END VIRTUAL WORKBENCH --- */
}
.status-badge {
    position: absolute;
    bottom: -1px;
    left: 50%;
    transform: translateX(-50%) translateY(50%);
    background-color: #1a2030;
    border: 1px solid;
    padding: 3px 11px;
    border-radius: 99px;
    font-size: 0.77rem;
    font-weight: 700;
}

/* Hangar/Shipyard Toggle Switch */
.toggle-container {
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 8px;
    padding: 3px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.4);
    transform: scale(0.72); 
    flex-shrink: 0; 
}
.toggle-switch {
    background-color: transparent;
    display: flex;
}
.toggle-label {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    flex-grow: 1;
    transition: all 0.3s ease;
    color: var(--ot-text-secondary);
    clip-path: polygon(0% 0%, 100% 0%, 100% 85%, 85% 100%, 0% 100%);
}
.toggle-label.shipyard {
    clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 15% 100%, 0% 85%);
}

#ship-terminal-container.mode-hangar .toggle-label.hangar,
#ship-terminal-container.mode-shipyard .toggle-label.shipyard {
    color: var(--ot-bg-dark);
    font-weight: 900;
}
#ship-terminal-container.mode-hangar .toggle-label.hangar { 
  
  background-color: var(--ot-hangar-red-base);
    box-shadow: 0 0 10px var(--ot-hangar-red-glow);
}
#ship-terminal-container.mode-shipyard .toggle-label.shipyard { 
    background-color: var(--ot-shipyard-blue-base);
    box-shadow: 0 0 10px var(--ot-shipyard-blue-glow);
}

/* Main Info Panels & Mode-Specific Spacing */
.info-panel-content { 
    display: none; 
    flex-grow: 1; /* Pushes buttons down */
    flex-direction: column;
}

/* --- VIRTUAL WORKBENCH START --- */
/* NEW: Header for info panel */
.info-panel-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    /* VIRTUAL WORKBENCH: Request B - Revert gap to 0.5rem to fix bars */
    gap: 0.5rem; 
}

.info-panel-text {
    flex-grow: 1; /* Allow text to take up remaining space */
    /* --- VIRTUAL WORKBENCH (QOL D) --- */
    min-width: 0; /* CRITICAL: Allows flex child to shrink below content size (truncation) */
    /* --- END VIRTUAL WORKBENCH --- */
    padding-right: 1.5rem;
}
/* --- VIRTUAL WORKBENCH END --- */


/* ADDED: Mode-specific rules for spacing above action buttons */
#ship-terminal-container.mode-hangar .ship-display-area,
#ship-terminal-container.mode-shipyard .info-panel-content {
    margin-bottom: 1rem;
}

#ship-terminal-container.mode-hangar .info-panel-hangar, 
#ship-terminal-container.mode-shipyard .info-panel-shipyard { 
    display: flex;
}

/* NEW: Ship Price Display for Shipyard */
.ship-price-display {
    margin-top: 0.5rem;
    color: var(--ot-cyan-base);
    text-shadow: 0 0 5px var(--ot-cyan-glow), 0 0 10px var(--ot-cyan-glow), 0 2px 4px rgba(0,0,0,0.8);
}


/* --- VIRTUAL WORKBENCH START --- */
/* NEW: Parameter Bars Styling */
.ship-param-bars {
    display: flex;
    flex-direction: column;
    gap: 0.3rem; /* Tighter spacing between bars */
    font-family: 'Roboto Mono', sans-serif;
    
    /* Sizing & Position */
    width: 40%;
    max-width: 160px; /* Constrain max width */
    flex-shrink: 0; /* Prevent shrinking */
    /* --- VIRTUAL WORKBENCH (QOL D) --- */
    margin-left: 1rem; /* Add buffer against text to accommodate scale expansion */
    /* --- END VIRTUAL WORKBENCH --- */

    /* Scale transform */
    transform: scale(1.25);
    transform-origin: top right;
}

.param-bar-item {
    display: flex;
    align-items: center;
    gap: 0.5rem; /* Space between label and bar */
}

.param-bar-label {
    /* VIRTUAL WORKBENCH: Request A - Reduced text size */
    font-size: 0.6rem; /* Was 0.65rem */
    color: var(--ot-text-secondary);
    text-transform: uppercase;
    width: 40px; /* Fixed width for alignment */
    text-align: right;
    flex-shrink: 0;
}

.param-bar-track {
    /* VIRTUAL WORKBENCH: Request D - Increased thickness */
    height: 12px; /* Was 10px */
    background-color: rgba(0,0,0,0.3);
    flex-grow: 1;
    border-radius: 4px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.5);
    overflow: hidden; /* Ensure fill stays inside */
    position: relative; /* For text overlay positioning */
}

.param-bar-fill {
    height: 100%;
    border-radius: 4px;
    box-shadow: 0 0 8px var(--bar-color);
    transition: width 0.4s ease-out;
    position: relative; /* For z-index */
    z-index: 1; /* Sits below text */
}

/* Quantitative text overlay */
.param-bar-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Default: center-aligned */
    z-index: 2; /* Sits on top of the fill */
    /* VIRTUAL WORKBENCH: Request A - Reduced text size */
    font-size: 0.55rem; /* Was 0.6rem */
    font-family: 'Roboto Mono', sans-serif;
    color: #ffffff;
    text-shadow: 0 0 2px #000, 0 0 4px #000; /* Shadow for readability */
    white-space: nowrap; /* Prevent line breaks */
    pointer-events: none; /* Allow clicks to pass through */
    /* VIRTUAL WORKBENCH: Request A - Reduce visibility */
    opacity: 0.7;
}

/* NEW: Alignment for maxed-out bars */
.param-bar-text.max {
    left: auto; /* Unset left */
    right: 5px; /* Position 5px from the right */
    transform: translateY(-50%); /* Center vertically only */
}

/* REMOVED: Shipyard-specific coloring rule */
/* --- VIRTUAL WORKBENCH END --- */


/* Action Buttons */
.action-button { 
    transition: transform 0.2s ease; 
    border-radius: 0.5rem; 
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.3rem 0.8rem;
}
.action-button:not(:disabled) {
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}
.action-button:active:not(:disabled) { transform: scale(0.98); filter: brightness(1.2); }
.action-button:disabled { opacity: 0.4; cursor: not-allowed; filter: grayscale(50%); }

/* --- VIRTUAL WORKBENCH: ADD 'BOARD' BUTTON GLOW CLASS --- */
.action-button.is-glowing-button {
    /* Use the cyan color variables */
    --ot-cyan-base: #22d3ee;
    --ot-cyan-glow: #67e8f9;
    /* Apply the new animation from global.css */
    /* VIRTUAL WORKBENCH: MODIFIED from 0.4s to 1.0s */
    animation: pulse-cyan-button-glow 1.0s ease-in-out;
}
/* --- END VIRTUAL WORKBENCH --- */

/* --- VIRTUAL WORKBENCH: ADD GREEN AND RED GLOW CLASSES (Request A & B) --- */
.action-button.is-glowing-green {
    /*
     * We don't need to set variables here.
     * The keyframes `pulse-green-button-glow` use:
     * --ot-green-accent (from :root)
     * --class-b-color (from :root)
    */
    animation: pulse-green-button-glow 1.0s ease-in-out;
}

.action-button.is-glowing-red {
    /*
     * We don't need to set variables here.
     * The keyframes `pulse-red-border-glow` are already defined
     * and use --ot-hangar-red-base and --ot-hangar-red-glow (from :root).
     * We just apply the animation with a 1.0s duration for the button.
    */
    animation: pulse-red-border-glow 1.0s ease-in-out;
}
/* --- END VIRTUAL WORKBENCH --- */


/* NEW: Price text specifically for action buttons (like Sell) */
.action-button-price {
    font-size: 1.1rem;
    color: var(--ot-cyan-base);
    text-shadow: 0 0 5px var(--ot-cyan-glow), 0 0 10px var(--ot-cyan-glow), 0 2px 4px rgba(0,0,0,0.8);
}

/* Flavor Text Styling */
.flavor-text-box {
    padding-left: 0.75rem;
    border-left: 2px solid;
    box-shadow: inset 3px 0 5px -2px rgba(0,0,0,0.5);
}

/* Inset Text Shadow for ship names/roles */
.inset-text-shadow {
    text-shadow: 0 2px 3px rgba(0,0,0,0.6);
}

/* Pagination Dots */
#hangar-pagination-wrapper {
    position: absolute;
    bottom: 1.25rem; /* The 55% value, as a gap from the bottom of the screen */
    left: 0;
    right: 0;
    z-index: 10; /* Ensure it's above the card content */

    flex-shrink: 0;
    overflow-x: auto;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    scrollbar-width: none;
    -ms-overflow-style: none;
    display: flex;
    justify-content: center;
}

#hangar-pagination-wrapper::-webkit-scrollbar {
    display: none;
}

#hangar-pagination {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    gap: 0.9775rem;
    width: max-content;
    padding: 0 1rem;
}

.pagination-dot {
    width: 1.8rem;
    height: 2.25rem;
    border-radius: 4px;
    background-color: var(--theme-color-primary, #4b5563);
    opacity: 0.3;
    transition: all 0.3s ease;
    cursor: pointer;
    pointer-events: auto; /* Make pagers interactive */
    display: block; 
}

.pagination-dot.active { 
    background-color: var(--theme-color-primary, #fde047);
    box-shadow: 0 0 8px var(--theme-glow-color, #fef08a);
    opacity: 1.0;
}

/* --- VIRTUAL WORKBENCH: QOL UPDATE B (Boarded Dot) --- */
.pagination-dot.boarded {
    /* Force white, irrespective of theme */
    background-color: #ffffff !important;
    opacity: 1.0 !important;
    box-shadow: 0 0 8px #ffffff, 0 0 15px rgba(255, 255, 255, 0.6);
}
/* --- END VIRTUAL WORKBENCH --- */

.pagination-dot.half {
    width: 0.9rem; /* Half the original width */
    opacity: 0.2;
}

/* Spec Cards (REMOVED) */

/* Responsive adjustments for smaller screens */
@media (max-width: 768px) {
    .ship-card-content-wrapper {
        grid-template-columns: 1fr; /* Stack columns vertically */
    }
    .ship-card-content-wrapper > .col-span-2,
    .ship-card-content-wrapper > .col-span-3 {
        grid-column: span 1 / span 1; /* Make each column take full width */
    }
    
.ship-display-area {
        min-height: 180px; /* Ensure hologram area has enough height */
    }
}

/* --- VIRTUAL WORKBENCH: ARCHIVE LINK STYLE (UPDATED) --- */
.archive-link {
    position: absolute;
    /* Use right: -90px; based on user feedback to pull it closer to the toggle, but keep it to the right. 
       Since the container is centered, this places it nicely to the side. 
    */
    left: 100%; 
    margin-left: 0.1rem; /* Reduced from 0.2rem to move it tighter */
    
    /* Use top: 50% to align with the middle of the toggle height, effectively moving it up */
    top: 50%; 
    transform: translateY(-50%); /* Center vertically */
    
    white-space: normal; /* Allow wrapping for <br> */
    text-align: center; /* Center align the stacked text */
    line-height: 0.9; /* Tight line height for stacked text */
    
    font-family: 'Oxanium', sans-serif;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    color: var(--ot-cyan-base); 
    text-shadow: 0 0 5px var(--ot-cyan-glow);
    cursor: pointer;
    pointer-events: auto;
    opacity: 0.7;
    transition: all 0.2s ease;
    z-index: 20;
}

.archive-link:hover {
    opacity: 1;
    text-shadow: 0 0 8px var(--ot-cyan-glow), 0 0 12px var(--ot-cyan-glow);
}

/* Mobile adjustment */
@media (max-width: 400px) {
    .archive-link {
        margin-left: 0.1rem;
        font-size: 0.6rem;
    }
}

/* --- VIRTUAL WORKBENCH: MODAL CONTENT STYLES (NEW) --- */
/* The wrapper for the lore text to ensure scrolling and max-height */
.ship-lore-modal-wrapper {
    max-height: 50vh; /* Limit height to 50% of viewport height */
    overflow-y: auto; /* Enable vertical scrolling */
    padding: 0 0.5rem; /* Add breathing room */
    margin-top: 0.5rem;
    
    /* Custom Scrollbar */
    scrollbar-width: thin;
    scrollbar-color: var(--ot-cyan-base) rgba(0,0,0,0.3);
}

.ship-lore-modal-wrapper::-webkit-scrollbar {
    width: 6px;
}
.ship-lore-modal-wrapper::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.3);
    border-radius: 3px;
}
.ship-lore-modal-wrapper::-webkit-scrollbar-thumb {
    background-color: var(--ot-cyan-base);
    border-radius: 3px;
}

/* Attribute Header Style (Refinement B) */
.ship-lore-attribute {
    text-align: center;
    color: var(--theme-color-primary, #fde047);
    font-family: 'Orbitron', sans-serif;
    font-size: 1rem;
    margin-bottom: 0.25rem; /* Reduced from 1.0rem */
    padding-bottom: 1.5rem; /* Increased from 0.5rem to act as <br> space */
    border-bottom: 1px solid rgba(255,255,255,0.1);
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 0 5px var(--theme-color-glow, #fef08a);
}

/* Main Lore Text Style (Refinement C) */
.ship-lore-text {
    font-family: 'Roboto Mono', monospace;
    font-size: 1.0rem; /* Increased from 0.9rem */
    line-height: 1.6;
    color: var(--ot-cyan-base); /* Updated to Teal */
    text-align: left; /* Changed from justify */
    white-space: pre-line; /* Preserve original line breaks in lore */
}

/* --- VIRTUAL WORKBENCH: GLOW CLASSES (Refinement Phase 5 - QOL UPDATE C) --- */
/* Updated to use a white-hot core stack for better fidelity */
.glow-text-z {
    /* Force white core for heat, let shadow define the color halo */
    color: #fff !important; 
    text-shadow:
        0 0 2px #000, /* Contrast Outline */
        0 0 5px var(--class-z-color), /* Tight Core */
        0 0 15px var(--class-z-color), /* Soft Glow */
        0 0 30px var(--class-z-color) !important; /* Wide Diffuse */
}
.glow-text-o {
     color: #fff !important;
     text-shadow:
        0 0 2px #000,
        0 0 5px var(--class-o-color),
        0 0 15px var(--class-o-color),
        0 0 30px var(--class-o-color) !important;
}
.glow-text-s {
     color: #fff !important;
     text-shadow:
        0 0 2px #000,
        0 0 5px var(--class-s-color),
        0 0 15px var(--class-s-color),
        0 0 30px var(--class-s-color) !important;
}
/* --- END VIRTUAL WORKBENCH --- */